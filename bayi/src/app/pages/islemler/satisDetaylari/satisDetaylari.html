<div class="separator-breadcrumb border-top mb-3"></div>

<div class="container-fluid m-1 w-100" style="height: calc(100vh - 120px); overflow-y: auto;">
    <div class="card">
        <div class="card-body">
            <form class="row m-0" validControl [formGroup]="satisEklemeFormu" (submit)="satisEkle(); islemiKaydet()">
                <div class="form-group col-md-8">
                    <select class="form-control" formControlName="e_odeme_tipi" title="Ödeme Şekli" required>
                        <option value="">-- Ödeme Şekli Seçiniz --</option>
                        <option value="{{odeme.e_odeme_tipi}}" *ngFor="let odeme of satisListesi">{{odeme.e_odeme_tipi}}</option>
                    </select>
                </div>
                <div class="form-group col-md-2">
                    <button type="button" class="btn btn-warning btn-block"><span class="fas fa-solid fa-eraser mr-1"></span> Yeni</button>
                </div>
                <div class="form-group col-md-2">
                    <button type="submit" class="btn btn-success btn-block"  *ngIf="!islemiKaydetBtn"><span class="fas fa-solid fa-check mr-1"></span> Kaydet</button>
                    <button class="btn btn-success btn-block" *ngIf="islemiKaydetBtn">
                        <div class="spinner-glow spinner-glow-light mt-0 mr-2"></div> Kaydeliyor
                    </button>
                </div>
                <div class="form-group col-md-2">
                    <button type="button" [ngClass]="{'btn btn-primary btn-block m-0': 1!=1, 'btn btn-outline-primary btn-block m-0': 1==1}" (click)="urunFilterData.e_cinsiyet = 'Erkek'; urunListele();"><span class="fas fa-solid fa-mars mr-1"></span> Erkek</button>
                </div>
                <div class="form-group col-md-2">
                    <button type="button" [ngClass]="{'btn btn-primary btn-block m-0': 1!=1, 'btn btn-outline-primary btn-block m-0': 1==1}" (click)="urunFilterData.e_cinsiyet = 'Kadın'; urunListele();"><span class="fas fa-solid fa-venus mr-1"></span> Kadın</button>
                </div>
                <div class="form-group col-md-2">
                    <button type="button" [ngClass]="{'btn btn-primary btn-block m-0': 1!=1, 'btn btn-outline-primary btn-block m-0': 1==1}" (click)="urunFilterData.e_cinsiyet = 'Unisex'; urunListele();"><span class="fas fa-solid fa-venus-mars mr-1"></span> Unisex</button>
                </div>
                <div class="form-group col-md-2">
                    <button type="button" class="btn btn-dark btn-block" (click)="urunFilterData.e_cinsiyet = ''; urunListele();"><span class="fas fa-sync mr-2"></span>Filtre Temizle</button>
                </div>
                <div class="form-group col-md-4">
                    <a href="http://localhost:5772/islemler/satisIslemleri"><button type="button" class="btn btn-outline-dark btn-block"><i class="fas fa-solid fa-angle-left ml-1"></i><strong> Satış Sayfasına Dön</strong></button></a>
                </div>
                <div class="form-group col-md-7">
                    <div class="alert alert-primary p-4" *ngIf="!urunListesi && !urunLoader">
                        <i class="ri-forbid-line fs-22 mr-3 valign-middle"></i>
                        <span class=" valign-middle">Listelemek istediğiniz ürün bulunamadı.</span>
                      </div> 
                        
                      <div class="alert alert-primary p-4" *ngIf="urunLoader">
                          <div class="spinner-glow spinner-glow-primary m-0 mr-4 valign-middle"></div>
                          <span class=" valign-middle">Ürün kayıtları listeleniyor, lütfen bekleyiniz.</span>
                      </div>
                    <div class="table-responsive" [hidden]="!urunListesi || urunLoader" style="height: 700px; overflow-y: auto">
                        <table class="table table-bordered table-hover">
                            <thead>
                            <tr class="alert-primary">
                                <th class="text-center w-10">Ürün Resmi</th>
                                <th class="text-center w-10">Ürün Kodu</th>
                                <th class="text-center w-35">Ürün Adı</th>
                                <th class="text-center w-5">Cinsiyet</th>
                                <th class="text-center w-20">Fiyat</th>
                                <th class="text-center w-15"></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr *ngFor="let urun of urunListesi">
                                <td class="text-left">
                                <img src="https://test.eronsoftware.com:5770/admin/uploads/stokKartIslemleri/{{urun.e_resim_uniq_id}}.{{urun.e_resim_dosya_uzantisi}}" height="80px" width="80px">
                                </td>
                                <td class="text-center">{{urun.e_stok_kart_kodu}}</td>
                                <td class="text-left">{{urun.e_stok_kart_adi}}</td>
                                <td class="text-left">{{urun.e_cinsiyet}}</td>
                                <td class="text-right" *ngIf="satisListesi[0].e_fiyat_politikasi == '1'">{{urun.e_fiyat_1 | currency: ' '}} ₺</td>
                                <td class="text-right" *ngIf="satisListesi[0].e_fiyat_politikasi == '2'">{{urun.e_fiyat_2 | currency: ' '}} ₺</td>
                                <td class="text-right" *ngIf="satisListesi[0].e_fiyat_politikasi == '3'">{{urun.e_fiyat_3 | currency: ' '}} ₺</td>
                                <td class="text-center">
                                    <button type="button" class="btn btn-primary btn-block" *ngIf="1==1" (click)="sepeteEkle(urun)"><span class="fas fa-solid fa-plus mr-1"></span> Sepete Ekle</button>
                                    <button type="button" class="btn btn-dark btn-block" *ngIf="1!=1"><span class="fas fa-solid fa-times mr-1"></span> Kaldır</button>
                                </td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <div class="form-group col-md-5">
                    <div class="card-header bg-transparent d-flex jc-space-between border-1-bottom mx-3" style="border-radius: 10px; width: 635px;">
                        <h5 class="m-0 mt-2"><span class="fas fa-solid fa-cart-plus"></span> Sepetim</h5>
                    </div>
                    <div class="alert alert-primary p-4 mt-2" *ngIf="!satisDetayListesi && !detayLoader">
                        <i class="ri-forbid-line fs-22 mr-3 valign-middle"></i>
                        <span class=" valign-middle">Sepetinizde ürün bulunmamaktadır.</span>
                    </div> 
                    <div class="alert alert-primary p-4 mt-2" *ngIf="detayLoader">
                        <div class="spinner-glow spinner-glow-primary m-0 mr-4 valign-middle"></div>
                        <span class=" valign-middle">Sepetinizdeki ürünler listeleniyor, lütfen bekleyiniz.</span>
                    </div>
                    <div class="table-responsive mt-2" *ngIf="satisDetayListesi" style="height: 700px; overflow-y: auto">
                        <table class="table table-bordered table-hover">
                            <thead>
                            <tr class="alert-primary">
                                <th class="text-center w-10">Ürün Kodu</th>
                                <th class="text-center w-40">Ürün Adı</th>
                                <th class="text-center w-20">Birim Fiyat</th>
                                <th class="text-center w-15"></th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr *ngFor="let detay of satisDetayListesi">
                                <td class="text-center">{{detay.e_stok_kart_kodu}}</td>
                                <td class="text-left">{{detay.e_stok_kart_adi}}</td>
                                <td class="text-right">{{detay.e_birim_fiyat | currency : ' '}} ₺</td>
                                <td class="text-center">
                                    <button type="button" class="btn btn-dark" *ngIf="!silinenKayitBtn[detay.e_id]" (click)="detaySilButton(detay, 'satisIslemleri/satisDetaySil');"><i class="fas fa-times"></i></button>
                                    <button type="button" class="btn btn-dark" *ngIf="silinenKayitBtn[detay.e_id]"><div class="spinner-glow spinner-glow-light mt-0"></div></button>
                                </td>
                            </tr>
                            <tr class="alert-primary">
                                <td></td>
                                <td></td>
                                <td class="text-right">TOPLAM : {{satisDetayListesi[0].ALT_TOPLAM | currency : ' '}} ₺</td>
                                <td></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>